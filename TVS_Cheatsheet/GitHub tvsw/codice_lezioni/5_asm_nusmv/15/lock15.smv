
MODULE main
VAR
	unLockReq : boolean;
	lock3 : single_lock (unLockReq, 7);
	lock2 : single_lock (lock3.unlock, 4);
	lock1 : single_lock (lock2.unlock, 6);
LTLSPEC
-- è sempre chiuso
G (! lock1.unlock)

MODULE single_lock (previousLock, key)
VAR
	digit : 0 .. 9;
	button : {up, down, none};
DEFINE
	unlock := digit = key & previousLock;
ASSIGN
	init (digit) := 0;
	next (digit) :=
		case
			button = up : (digit + 1) mod 10;
			button = down : (digit + 9) mod 10;
			TRUE : digit;
		esac;
	
